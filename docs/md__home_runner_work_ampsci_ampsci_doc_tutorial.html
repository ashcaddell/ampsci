<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ampsci: Basic Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="./MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ampsci
   </div>
   <div id="projectbrief">c++ program for high-precision atomic structure calculations of single-valence systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Basic Tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Basic tutorial for using ampsci, including examples</p>
<p>[Home]</p>
<p>This assumes you already have ampsci compiled.</p>
<ul>
<li>See <a class="el" href="md__home_runner_work_ampsci_ampsci_doc_compilation.html">doc/compilation.md</a> for compilation instructions</li>
<li>See <a class="el" href="md__home_runner_work_ampsci_ampsci_doc_tutorial_advanced.html">doc/tutorial_advanced.md</a> for a more advanced tutorial, including correlation corrections</li>
</ul>
<h1>Contents</h1>
<ul>
<li><a href="#start">Getting started</a></li>
<li><a href="#basic">Running basic calculations</a></li>
<li><a href="#input">Setting up the input file</a><ul>
<li><a href="#example">Example: running calculation using input file</a></li>
</ul>
</li>
<li><a href="#output">Output format</a></li>
<li><a href="#modules">Modules: using the wavefunctions</a></li>
</ul>
<h1>Getting started <a class="anchor" id="start"></a></h1>
<p>Open up a terminal and navigate to the directory where ampsci was compiled</p>
<ul>
<li>If you are unsure using the terminal, see <a href="https://ubuntu.com/tutorials/command-line-for-beginners">this tutorial (ubuntu)</a> (It's specifically for ubuntu (linux), but is mostly the same on mac)</li>
</ul>
<p>First, just run the executable:</p>
<div class="fragment"><div class="line">./ampsci</div>
</div><!-- fragment --><p>No calculation was performed, however, some intructions should be printed to the screen. These should serve as a reminder if you forget any of the commands we will look at blow. You can also run:</p>
<div class="fragment"><div class="line">./ampsci -h</div>
</div><!-- fragment --><p>which will print the same, along with some more detailed 'help' information. You can ingore this output for now, as we'll work through the basic examples.</p>
<p>Now, try the following, which should print the current <em>version</em> info (including the git commit hash, if you're using git). You can use this to check which exact version of the code you are running. This is also automatically printed when you run any calculation.</p>
<div class="fragment"><div class="line">./ampsci -v</div>
</div><!-- fragment --><h1>Running basic calculations <a class="anchor" id="basic"></a></h1>
<p>To actually perform an atomic calculation, we need to tell ampsci what we want to calculate.</p>
<p>Typically, this is done using an input file where we specify all the options. For very simple calculations, however, we can do this directly from the command line using the form:</p>
<div class="fragment"><div class="line">./ampsci &lt;Atom&gt; &lt;Core&gt; &lt;Valence&gt;</div>
</div><!-- fragment --><p>(where <code>&lt;Core&gt;</code> and <code>&lt;Valence&gt;</code> are both optional). For example, the following should all produce the same result. They will calculate Hartree-Fock for Cs, including all the electrons in the "core" (so-called \(V^N\) approximation).</p>
<div class="fragment"><div class="line">./ampsci Cs</div>
<div class="line">./ampsci Cs [Cs]</div>
<div class="line">./ampsci Cs [Xe],6s1</div>
</div><!-- fragment --><ul>
<li>The format for the "core" configuration copies that used by NIST in their periodic table. A nice copy can be downloaded from <a href="https://www.nist.gov/image/periodic-table">here</a>.</li>
<li>Usually the term in the brackets <code>[]</code> is a noble gas, but in ampsci you can put any atom (the core configuration for non-noble-gas atoms is guessed based on simple filling rules, and is sometimes not correct, so always check the output!).</li>
</ul>
<p>The next few cases will calculate Hartree-Fock for Cs, using the \(V^{N-1}\) approximation, including valence states up to \(n=7\) for \(s\) and \(p\) states, and \(n=5\) for \(d\) states:</p>
<div class="fragment"><div class="line">./ampsci Cs [Xe] 7sp5d</div>
</div><!-- fragment --><h1>Setting up the input file <a class="anchor" id="input"></a></h1>
<p>For anything more complicated, we must use an input file. The input file is a plain-text file; a full description of the format is given <a class="el" href="md__home_runner_work_ampsci_ampsci_doc_ampsci_input.html">elsewhere</a> - here we will run through a basic example.</p>
<ul>
<li>See <a class="el" href="md__home_runner_work_ampsci_ampsci_doc_ampsci_input.html">doc/ampsci_input.md</a> for detail input descriptions</li>
</ul>
<p>Firstly, we can use the code to tell us which input options are available using the <code>-a</code> (or <code>--ampsci</code>) command-line option:</p>
<div class="fragment"><div class="line">./ampsci -a</div>
</div><!-- fragment --><p>This will print the list of available top-level "Input Blocks". The output will look something like this:</p>
<div class="fragment"><div class="line">Available ampsci options/blocks are:</div>
<div class="line">ampsci{</div>
<div class="line">  /*</div>
<div class="line">  Format for descriptions are:</div>
<div class="line"> Description [default_value]</div>
<div class="line"> Blocks end with &#39;{}&#39;, options end with &#39;;&#39;</div>
<div class="line">  */</div>
<div class="line">  Atom{}        // Which atom to run for</div>
<div class="line">  Grid{}        // Set radial grid parameters</div>
<div class="line">  HartreeFock{} // Options for Solving atomic system</div>
<div class="line">  Nucleus{}     // Set nuclear parameters</div>
<div class="line">  RadPot{}      // Inlcude QED radiative potential</div>
<div class="line">  Basis{}       // Basis of HF eigenstates used for MBPT</div>
<div class="line">  Spectrum{}    // Like basis, but includes correlations. Used for sum-over-states</div>
<div class="line">  Correlations{}        // Options for correlations</div>
<div class="line">  ExtraPotential{}      // Include an extra potential. Rarely used.</div>
<div class="line">  dVpol{}       // Approximate correlation (polarisation) potential. Rarely used.</div>
<div class="line">  Module::*{}   // Run any number of modules (* -&gt; module name)</div>
<div class="line">}</div>
</div><!-- fragment --><p>This will be in the correct format for the input file, so we can start making our input file by copy+pasting these. We don't need all the options, so let's start with just the basics: <code>Atom{}</code>, <code>Grid{}</code>, and <code>HartreeFock{}</code>. In each of these blocks, we can specify certain options; most have default values, and can be thus left blank. We can also ask the code to tell us which options are available for each block, for example:</p>
<div class="fragment"><div class="line">./ampsci -a Atom</div>
</div><!-- fragment --><p>The output will list all options for the <code>Atom{}</code> block:</p>
<div class="fragment"><div class="line">Available Atom options/blocks are:</div>
<div class="line">Atom{</div>
<div class="line">  Z;    // string or int (e.g., Cs equivilant to 55). Atomic number [default H]</div>
<div class="line">  A;    // int. Atomic mass number (set A=0 to use pointlike nucleus) [default based on Z]</div>
<div class="line">  varAlpha2;    // Fractional variation of the fine-structure constant, alpha^2: d(a^2)/a_0^2. Use to enforce the non-relativistic limit (c-&gt;infinity =&gt; alpha-&gt;0), or calculate sensitivity to variation of alpha. [1.0]</div>
<div class="line">}</div>
</div><!-- fragment --><p>This is also in the correct format, so we can copy+paste into our input file.</p>
<ul>
<li>Anything after <code>//</code> is a comment and will be ignored by the program.</li>
<li>Don't forget to close the curly braces <code>}</code> at the end of each input block, and the semi-colon <code>;</code> after each option!</li>
</ul>
<p>We can list more than one block name for this. For example, try:</p>
<div class="fragment"><div class="line">./ampsci -a Grid HartreeFock</div>
</div><!-- fragment --><p>which will give something like:</p>
<div class="fragment"><div class="line">Available Grid options/blocks are:</div>
<div class="line">Grid{</div>
<div class="line">  /*</div>
<div class="line">  Options for radial grid (lattice) used for integrations, solving equations and storing oritals. All relevant quantities are in units of Bohr radius (aB).</div>
<div class="line">  */</div>
<div class="line">  r0;   // Initial grid point, in aB [1.0e-6]</div>
<div class="line">  rmax; // Finial grid point [120.0]</div>
<div class="line">  num_points;   // Number of grid points [2000]</div>
<div class="line">  type; // Type of grid: loglinear, logarithmic, linear [loglinear]</div>
<div class="line">  b;    // Only used for loglinear: grid is ~ logarithmic for r&lt;b, linear for r&gt;b [rmax/3]</div>
<div class="line">  du;   // du is uniform grid step size; set this instead of num_points - will override num_points [default set by num_points]. Rarely used.</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">Available HartreeFock options/blocks are:</div>
<div class="line">HartreeFock{</div>
<div class="line">  /*</div>
<div class="line">  Options for solving lowest-order atomic wavefunction</div>
<div class="line">  */</div>
<div class="line">  core; // Core configuration. Either list entire core, or use [At] short-hand. e.g., [He] equivilant to 1s2; [Xe],6s1 equivilant to [Cs] and to 1s2,2s2,...,5p6,6s1. [blank by default]</div>
<div class="line">  valence;      // e.g., 7sp5d will include valence states up to n=7 for s and p, but n=5 for d states. Automatically excludes states in the core. [blank by default]</div>
<div class="line">  eps;  // HF convergance goal [1.0e-13]</div>
<div class="line">  method;       // HartreeFock, Hartree, KohnSham, Local [HartreeFock]</div>
<div class="line">  Breit;        // Scale for factor for Breit Hamiltonian. Usially 0.0 (no Breit) or 1.0 (full Breit), but can take any value. [0.0]</div>
<div class="line">  sortOutput;   // Sort energy tables by energy? [false]</div>
<div class="line">}</div>
</div><!-- fragment --><h2>Example: running calculation using input file <a class="anchor" id="example"></a></h2>
<p>We will use the above to create our first simple We will call this text file <code>example.in</code>, but any filename is OK (the <code>.in</code> file extension is just by convention; you may use <code>.txt</code> or anything else). We may then set up the input file like:</p>
<div class="fragment"><div class="line">// example.in</div>
<div class="line">Atom{</div>
<div class="line">  Z = Cs; // Or Z = 55;</div>
<div class="line">  A = 133; // may leave blank for default isotope</div>
<div class="line">}</div>
<div class="line">Grid{</div>
<div class="line">  r0 = 1.0e-6;</div>
<div class="line">  rmax = 150.0;</div>
<div class="line">  num_points = 3000;</div>
<div class="line">}</div>
<div class="line">HartreeFock{</div>
<div class="line">  core = [Xe];</div>
<div class="line">  valence = 7sp5d;</div>
<div class="line">}</div>
</div><!-- fragment --><p>From the <code>Atom{}</code> block, we have chosen to run calculations for Cs-133. Since we did not set any parameters in the <code>Nucleus{}</code> block, the code will run using the default nuclear parameters (which are looked up based on the isotope).</p>
<p>In the <code>Grid{}</code> block, we specify the descrete radial grid to have <code>3000</code> grid points dispersed between the range <code>[1.0e-6, 150.0]</code> atomic units (atomic unit of length is the Bohr radius: \(1\,{\rm au}=1\,a_0 = \tfrac{4\pi\epsilon_0\hbar^2}{m_e e^2}\approx 5.3\times10^{-11}\,{\rm m}\)). Since we did not specify a grid <code>type</code> the default (log-linear) will be used (see <a href="https://ampsci.dev/ampsci.pdf">ampsci.pdf</a>).</p>
<p>Finally, in the <code>HartreeFock{}</code> block, we specify that we wish to solve Hartree-Fock equations for Cs with a Xe-like core, and consider valence states up to \(n=5\) for \(s,p\)-states, and \(n=5\) for \(d\)-states. Since a Xenon-like core has 1 fewer electrons than neutral Cs, this is a \(V^{N-1}\) calculation. Note that the format for the core configuration copies that used by NIST in their periodic table. A nice copy can be downloaded from <a href="https://www.nist.gov/image/periodic-table">here</a>.</p>
<p>You may also use the built-in periodic table to see the possible ground-state electron configuration:</p>
<div class="fragment"><div class="line">./ampsci -p</div>
<div class="line">or</div>
<div class="line">./ampsci -p Cs</div>
</div><!-- fragment --><p>Caution: this "guesses" the configuration based on simple filling rules, so may not be the true ground-state configuration.</p>
<h1>Output format <a class="anchor" id="output"></a></h1>
<p>If we run the code with the above input file:</p>
<div class="fragment"><div class="line">./ampsci example.in</div>
</div><!-- fragment --><p>we will get something like the following output:</p>
<div class="fragment"><div class="line">********************************************************************************</div>
<div class="line">AMPSCI v: 0.0 [dev/f06534f0]</div>
<div class="line">Compiled: g++-11 [Ubuntu 11.1.0-1ubuntu1~18.04.1] 11.1.0 2022-09-14 12:42 AEST</div>
<div class="line">Run time: 2022-09-14 17:01:02</div>
<div class="line"> </div>
<div class="line">********************************************************************************</div>
<div class="line">Atom { </div>
<div class="line">  Z = Cs;</div>
<div class="line">  A = 133;</div>
<div class="line">}</div>
<div class="line">Grid { </div>
<div class="line">  r0 = 1.0e-6;</div>
<div class="line">  rmax = 150.0;</div>
<div class="line">  num_points = 3000;</div>
<div class="line">}</div>
<div class="line">HartreeFock { </div>
<div class="line">  core = [Xe];</div>
<div class="line">  valence = 7sp5d;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">Running for Cs, Z=55 A=133</div>
<div class="line">Fermi nucleus;  r_rms = 4.8041, c_hdr = 5.67073, t = 2.3</div>
<div class="line">Log-linear (b=50) grid: 1e-06-&gt;150, N=3000, du=0.36389</div>
<div class="line">========================================================</div>
<div class="line">Hartree-Fock</div>
<div class="line">Core   :  it: 28 eps=8.2e-14 for 5p+</div>
<div class="line">Val    :  it: 38 eps=0.0e+00 for 6s+ [ 38 eps=0e+00 for 6s+]</div>
<div class="line"> </div>
<div class="line">CsI-133</div>
<div class="line">Core: [Xe] (V^N-1)</div>
<div class="line">     state  k   Rinf its   eps         En (au)        En (/cm)</div>
<div class="line">0   1s_1/2 -1    0.7  2  3e-26 -1330.118948369  -291927365.862</div>
<div class="line">1   2s_1/2 -1    1.7  2  2e-23  -212.564531430   -46652522.176</div>
<div class="line">2   2p_1/2  1    1.7  2  9e-24  -199.429544824   -43769725.833</div>
<div class="line">3   2p_3/2 -2    1.8  2  1e-23  -186.436652692   -40918115.622</div>
<div class="line">4   3s_1/2 -1    3.6  2  1e-21   -45.969754343   -10089194.888</div>
<div class="line">5   3p_1/2  1    3.8  2  7e-22   -40.448315684    -8877379.174</div>
<div class="line">6   3p_3/2 -2    4.0  2  7e-22   -37.894321341    -8316842.207</div>
<div class="line">7   3d_3/2  2    4.6  2  4e-22   -28.309520222    -6213221.515</div>
<div class="line">8   3d_5/2 -3    4.6  2  5e-22   -27.775176728    -6095946.673</div>
<div class="line">9   4s_1/2 -1    7.9  2  1e-20    -9.512819127    -2087822.471</div>
<div class="line">10  4p_1/2  1    9.0  2  8e-21    -7.446283820    -1634270.397</div>
<div class="line">11  4p_3/2 -2    9.3  2  9e-21    -6.920999547    -1518983.824</div>
<div class="line">12  4d_3/2  2   13.2  2  6e-21    -3.485619409     -765005.035</div>
<div class="line">13  4d_5/2 -3   13.3  2  6e-21    -3.396901915     -745533.796</div>
<div class="line">14  5s_1/2 -1   20.3  2  7e-21    -1.489803443     -326974.061</div>
<div class="line">15  5p_1/2  1   26.3  2  3e-21    -0.907896946     -199260.348</div>
<div class="line">16  5p_3/2 -2   27.3  2  3e-21    -0.840338411     -184432.963</div>
<div class="line">E_c = -7786.643737</div>
<div class="line">Val: state  k   Rinf its   eps         En (au)        En (/cm)   En (/cm)</div>
<div class="line">0   6s_1/2 -1   70.8  1  0e+00    -0.127368053      -27954.056       0.00</div>
<div class="line">1   7s_1/2 -1  110.4  1  0e+00    -0.055187351      -12112.224   15841.83</div>
<div class="line">2   6p_1/2  1   87.2  1  0e+00    -0.085615846      -18790.506    9163.55</div>
<div class="line">3   7p_1/2  1  128.1  1  0e+00    -0.042021373       -9222.625   18731.43</div>
<div class="line">4   6p_3/2 -2   88.2  1  0e+00    -0.083785436      -18388.778    9565.28</div>
<div class="line">5   7p_3/2 -2  129.1  1  0e+00    -0.041368028       -9079.233   18874.82</div>
<div class="line">6   5d_3/2  2  101.5  1  0e+00    -0.064419644      -14138.478   13815.58</div>
<div class="line">7   5d_5/2 -3  101.5  1  0e+00    -0.064529777      -14162.649   13791.41</div>
<div class="line"> </div>
<div class="line">ampsci: T = 522.26 ms</div>
</div><!-- fragment --><p>For calculations that matter, the <em>entire</em> output should be saved. The best way to do this is to forward the ouput directly to a text file when running the code. The input options and the ampsci version details are also printed, so that the program output contains all required info to exactly reproduce it. A nice way to do this is by <code>piping</code> the ouput through the unix <code>tee</code> program: e.g.,</p>
<div class="fragment"><div class="line">./ampsci example.in |tee -a example.out</div>
</div><!-- fragment --><ul>
<li>Runs ampsci using input options in file "example.in".</li>
<li>Output will both be written to screen, and <em>appended</em> (due to the <code>-a</code>) to file "example.out".</li>
</ul>
<p>It's important to understand the meaning of the program output. The first part of the output just prints the version information for ampsci. This is imortant for reproducing old results, which may depend on the ampsci version.</p>
<p>Then, the entire set of input options is printed. This is useful, since it tells you explicitely which calculations were run, and is very useful for catching mistakes and reproducing old calculations. Importantly, the format is exactly what is required on input, so to re-run the calculation, this can simply be copy+pasted into a new input file.</p>
<div class="fragment"><div class="line">Running for Cs, Z=55 A=133</div>
<div class="line">Fermi nucleus;  r_rms = 4.8041, c_hdr = 5.67073, t = 2.3</div>
<div class="line">Log-linear (b=50) grid: 1e-06-&gt;150, N=3000, du=0.36389</div>
</div><!-- fragment --><ul>
<li>This tells you atom and isotope for which the calculations were run, the exact nuclear parameters used (these are for the finite-nuclear size effect), and the exact grid parameters used.</li>
</ul>
<div class="fragment"><div class="line">Hartree-Fock</div>
<div class="line">Core   :  it: 28 eps=8.2e-14 for 5p+</div>
<div class="line">Val    :  it: 38 eps=0.0e+00 for 6s+ [ 38 eps=0e+00 for 6s+]</div>
</div><!-- fragment --><ul>
<li>This is one of the most important outputs to check.</li>
<li>This tells us that Hartree-Fock equations for the core converged to parts in \(10^{14}\) in 28 iterations, and the worst core state convergance was for \(5p_{3/2}\).</li>
<li>The worst valence state converged to <code>0</code> (i.e., floating point underflowed) in 38 iterations</li>
<li>It's important to check that none of these 'epsilon' values are large (i.e., \(\epsilon\lesssim10^{-6}\)), otherwise it means Hartree-Fock didn't converge properly, and the calculations will be unreliable. This is rarely an issue.</li>
</ul>
<div class="fragment"><div class="line">CsI-133</div>
<div class="line">Core: [Xe] (V^N-1)</div>
<div class="line">     state  k   Rinf its   eps         En (au)        En (/cm)</div>
<div class="line">0   1s_1/2 -1    0.7  2  3e-26 -1330.118948369  -291927365.862</div>
<div class="line">1   2s_1/2 -1    1.7  2  2e-23  -212.564531430   -46652522.176</div>
<div class="line">2   2p_1/2  1    1.7  2  9e-24  -199.429544824   -43769725.833</div>
<div class="line">3   2p_3/2 -2    1.8  2  1e-23  -186.436652692   -40918115.622</div>
<div class="line">4   3s_1/2 -1    3.6  2  1e-21   -45.969754343   -10089194.888</div>
<div class="line">5   3p_1/2  1    3.8  2  7e-22   -40.448315684    -8877379.174</div>
<div class="line">6   3p_3/2 -2    4.0  2  7e-22   -37.894321341    -8316842.207</div>
<div class="line">7   3d_3/2  2    4.6  2  4e-22   -28.309520222    -6213221.515</div>
<div class="line">8   3d_5/2 -3    4.6  2  5e-22   -27.775176728    -6095946.673</div>
<div class="line">9   4s_1/2 -1    7.9  2  1e-20    -9.512819127    -2087822.471</div>
<div class="line">10  4p_1/2  1    9.0  2  8e-21    -7.446283820    -1634270.397</div>
<div class="line">11  4p_3/2 -2    9.3  2  9e-21    -6.920999547    -1518983.824</div>
<div class="line">12  4d_3/2  2   13.2  2  6e-21    -3.485619409     -765005.035</div>
<div class="line">13  4d_5/2 -3   13.3  2  6e-21    -3.396901915     -745533.796</div>
<div class="line">14  5s_1/2 -1   20.3  2  7e-21    -1.489803443     -326974.061</div>
<div class="line">15  5p_1/2  1   26.3  2  3e-21    -0.907896946     -199260.348</div>
<div class="line">16  5p_3/2 -2   27.3  2  3e-21    -0.840338411     -184432.963</div>
<div class="line">E_c = -7786.643737</div>
</div><!-- fragment --><ul>
<li>This is the output for the core states.</li>
<li>The columns are:<ul>
<li><code>state</code>: which core state</li>
<li><code>k</code>: value of \(\kappa\) (Dirac quantum number) for state</li>
<li><code>Rinf</code>: Radius of the 'practicle infinity', i.e., point on the radial grid where that orbital can be safely said to be zero. It's crucial to check all of these values lie well below <code>rmax</code> (set in <code>Grid{}</code>). If these are close to <code>rmax</code>, <code>rmax</code> should be increased.</li>
<li><code>its</code>: Number of iterations it took to solve the single-particle Dirac equation upon the final Hartree-Fock iteration</li>
<li><code>eps</code>: Extent to which the single-particle energy converged when solving the Dirac equation upon the last Hartree-Fock iteration. These numbers should be extremely small; if any are larger, it means there is possibly a serious numerical error. Normally, these will always be fine, so long as Hartree-Fock converged</li>
<li><code>En (au)</code> and <code>En (/cm)</code> are the single-particle (binding) energies in atomic units and \({\rm cm}^{-1}\), respectively. Atomic unit for energy is the Hartree: \(E_h = 2 Ry = \frac{\hbar^2}{m_e a_0^2} \approx 27.2\,{\rm eV}\).</li>
<li>The final numer <code>E_c</code> is the total Hartree-Fock energy of the core, in atomic units</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line">Val: state  k   Rinf its   eps         En (au)        En (/cm)   En (/cm)</div>
<div class="line">0   6s_1/2 -1   70.8  1  0e+00    -0.127368053      -27954.056       0.00</div>
<div class="line">1   7s_1/2 -1  110.4  1  0e+00    -0.055187351      -12112.224   15841.83</div>
<div class="line">2   6p_1/2  1   87.2  1  0e+00    -0.085615846      -18790.506    9163.55</div>
<div class="line">3   7p_1/2  1  128.1  1  0e+00    -0.042021373       -9222.625   18731.43</div>
<div class="line">4   6p_3/2 -2   88.2  1  0e+00    -0.083785436      -18388.778    9565.28</div>
<div class="line">5   7p_3/2 -2  129.1  1  0e+00    -0.041368028       -9079.233   18874.82</div>
<div class="line">6   5d_3/2  2  101.5  1  0e+00    -0.064419644      -14138.478   13815.58</div>
<div class="line">7   5d_5/2 -3  101.5  1  0e+00    -0.064529777      -14162.649   13791.41</div>
</div><!-- fragment --><ul>
<li>Finally, we have the output for the valence states</li>
<li>Most of these are the same as above, except there is an extra column, which gives the excitation energies (in \({\rm cm}^{-1}\)) relative to the lowest valence state (useful for comparing with <a href="https://physics.nist.gov/PhysRefData/ASD/levels_form.html">NIST database</a>)</li>
</ul>
<p>To do more complicated calculations, including constructing complete set of basis orbitals, and including core-valence correlations, see:</p>
<ul>
<li><a href="https://ampsci.dev/ampsci.pdf">ampsci.pdf</a> for full physics description of what the code can do</li>
<li><a class="el" href="md__home_runner_work_ampsci_ampsci_doc_ampsci_input.html">doc/ampsci_input.md</a> for detail on all input options</li>
</ul>
<h1>Modules: using the wavefunctions <a class="anchor" id="modules"></a></h1>
<p>Above, we ran ampsci, which calculated the atomic wavefunctions and printed their energies to screen. If we want to actually <em>do</em> anything with the wavefunctions, we have to run one or more <b>modules</b>. We do this by adding a module block to the input file, which has the form <code>Module::ModuleName{}</code></p>
<p>Here, we will just consider a simple example. For further detail:</p>
<ul>
<li>See <a class="el" href="md__home_runner_work_ampsci_ampsci_doc_modules.html">doc/modules.md</a> for details of currently avalable modules</li>
<li>The code is designed so that you can easily create your own modules. See <a class="el" href="md__home_runner_work_ampsci_ampsci_doc_writing_modules.html">doc/writing_modules.md</a> for details</li>
</ul>
<p>We can see a list of all available modules with the <code>-m</code> command-line option</p>
<div class="fragment"><div class="line">./ampsci -m</div>
</div><!-- fragment --><p>Many are listed. Here we will consider the simple/common example of <code>matrixElements</code> module, which (unsurprisingly) calculates matrix elements.</p>
<p>To see the available options for this block, list the block name after <code>-m</code> on the command-line:</p>
<div class="fragment"><div class="line">./ampsci -m matrixElements</div>
</div><!-- fragment --><p>which prints:</p>
<div class="fragment"><div class="line">Available Module::Matrixelements options/blocks are:</div>
<div class="line">Module::Matrixelements{</div>
<div class="line">  operator;     // e.g., E1, hfs</div>
<div class="line">  options{}     // options specific to operator; blank by dflt</div>
<div class="line">  rpa;  // true(=TDHF), false, TDHF, basis, diagram</div>
<div class="line">  omega;        // Text or number. Freq. for RPA. Put &#39;each&#39; to solve at correct frequency for each transition. [0.0]</div>
<div class="line">  radialIntegral;       // false by dflt (means red. ME)</div>
<div class="line">  printBoth;    // print &lt;a|h|b&gt; and &lt;b|h|a&gt; (dflt false)</div>
<div class="line">  onlyDiagonal; // only &lt;a|h|a&gt; (dflt false)</div>
<div class="line">}</div>
</div><!-- fragment --><p>The first option, <code>operator</code> is which operator we want to calculate matrix elements of. You can see a list of operators with the <code>-o</code> command-line option:</p>
<div class="fragment"><div class="line">./ampsci -o</div>
</div><!-- fragment --><p>The second option, which is a sub-input-block, <code>options</code> is the set of options for the given operator. Most operators have no extra options, so this can be left blank. Some (e.g., hyperfine operatr <code>hfs</code> have many available options). Like above, you can see the available options by further passing the operator name after <code>-o</code>. For example:</p>
<div class="fragment"><div class="line">./ampsci -o hfs</div>
</div><!-- fragment --><p>Here we will consider the simpler <code>E1</code> operator. To our above <code>exampl.in</code> file, we can add the following block (note we may add as many Module:: blocks as we like, they will all be run one-by-one in order):</p>
<div class="fragment"><div class="line">// example.in</div>
<div class="line">// ... above input options ...</div>
<div class="line">Module::Matrixelements{</div>
<div class="line">  operator = E1;</div>
<div class="line">  rpa = true;</div>
<div class="line">  omega = 0.0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The <code>omega = 0.0;</code> option means we have solved RPA equations for each transition at zero frequency. It is also possible to automatically solve RPA for each transition frequncy by setting: <code>omega = each;</code>. See <a href="https://ampsci.dev/ampsci.pdf">ampsci.pdf</a> for description of RPA.</p>
<p>The output format will depend on the specific module. In this case, we are shown the extent to which the RPA (/TDHF) equations converged, and then the valued of the reduced matrix elements are printed (at the Hartree-Fock, first-order core-polarisation, and all-orders RPA levels) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Sep 26 2022 05:28:38 for ampsci by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
